//     subject
//     (c) simonfan
//     subject is licensed under the MIT terms.

//     Iterator
//     (c) simonfan
//     Iterator is licensed under the MIT terms.

//     Deep
//     (c) simonfan
//     Deep is licensed under the MIT terms.

//     Containers
//     (c) simonfan
//     Containers is licensed under the MIT terms.

//     ObjectMatcher
//     (c) simonfan
//     ObjectMatcher is licensed under the MIT terms.

//     BackboneUiDraggable
//     (c) simonfan
//     BackboneUiDraggable is licensed under the MIT terms.

define("__backbone-ui-draggable/helpers",["require","exports","module"],function(e,t){t.min=function(e,t){return isNaN(e)?t:isNaN(t)?e:t>e?e:t},t.max=function(e,t){return isNaN(e)?t:isNaN(t)?e:e>t?e:t},t.fitValueWithin=function(e,t,r){return isNaN(t)||(e=e>t?e:t),isNaN(r)||(e=r>e?e:r),e};var r=/^-?\d*(\.\d+)?$/;t.stringifyPositionalValue=function(e){return r.test(e)?e+"px":e}}),define("subject",["lodash"],function(e){var t={initialize:function(){}},r=function(){};return r.prototype=t,r.proto=function(t,r){return e.isObject(t)?e.assign(this.prototype,t):this.prototype[t]=r,this},r.extend=function(t,r,n){var i,o;e.isFunction(t)?(i=e.assign({},r,{initialize:t}),o=n):e.isObject(t)&&(i=t||{},o=n);var a,s=this;return a=function(){var e=Object.create(a.prototype);return e.initialize.apply(e,arguments),e},e.assign(a,s,o),a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.proto(i),a.__super__=s.prototype,a},r.extend.bind(r)}),define("iterator/base",["subject","lodash"],function(e,t){var r=e(function(e,t){this.data=e,t=t||{},this.currentIndex=t.startAt||-1,this.options=t,this.evaluate=t.evaluate||t.evaluator||this.evaluate});r.proto({move:function(e){return this.index(this.currentIndex+e),this},evaluate:function(e){return e},evaluator:function(e){return this.evaluate=e,this},start:function(){return this.currentIndex=-1,this},end:function(){return this.currentIndex=this.length(),this},index:function(e){if(e>this.length()-1||0>e)throw new Error("No such index "+e);return this.currentIndex=e,this},countBefore:function(){return this.currentIndex+1},countAfter:function(){return this.length()-(this.currentIndex+1)},range:function(e,t){for(var r=[];t>=e;)r.push(this.at(e)),e++;return r},hasNext:function(){return this.currentIndex<this.length()-1},next:function(){return this.move(1),this.current()},nextN:function(e){for(var t=[],r=this.currentIndex+e-1;this.hasNext()&&this.currentIndex<=r;)t.push(this.next());return t},hasPrevious:function(){return this.currentIndex>0},previous:function(){return this.move(-1),this.current()},previousN:function(e){for(var t=[],r=this.currentIndex-e+1;this.hasPrevious()&&this.currentIndex>=r;)t.push(this.previous());return t},current:function(){return this.at(this.currentIndex)},value:function(){return this.data}}),r.proto({hasPrev:r.prototype.hasPrevious,prev:r.prototype.previous,prevN:r.prototype.previousN});var n=["map","filter","compact","difference"];return t.each(n,function(e){r.proto(e,function(){var r=t(this.data);r=r[e].apply(r,arguments);var n=this.constructor(r.value());return n})}),r}),define("iterator/array",["require","exports","module","./base","lodash"],function(e){var t=e("./base"),r=e("lodash"),n=t.extend({at:function(e){return this.evaluate(this.data[e],e)},length:function(){return this.data.length}}),i=["push","reverse","shift","sort","splice","unshift"];return r.each(i,function(e){n.proto(e,function(){return this.data[e].apply(this.data,arguments),this})}),r.each(["concat","slice"],function(e){n.proto(e,function(){var t=this.data[e].apply(this.data,arguments);return this.constructor(t)})}),n}),define("iterator/object",["require","exports","module","./base","lodash"],function(e){var t=e("./base"),r=e("lodash"),n=t.extend({initialize:function(e,n){n=n||{},t.prototype.initialize.apply(this,arguments),this.order=n.order||r.keys(e)},keyAt:function(e){return this.order[e]},at:function(e){var t=this.keyAt(e),r=this.data[t];return this.evaluate(r,t)},length:function(){return this.order.length},nextKey:function(){return this.keyAt(this.currentIndex+1)},currentKey:function(){return this.keyAt(this.currentIndex)},previousKey:function(){return this.keyAt(this.currentIndex-1)},map:function(e){var t={};return r.each(this.order,function(r,n){t[r]=e(this.data[r],r,n)}.bind(this)),this.constructor(t)}});return n.proto("constructor",n),n}),define("iterator/number",["require","exports","module","./base"],function(e){var t=e("./base"),r=t.extend({at:function(e){return this.evaluate(e,e)},length:function(){return this.data}});return r}),define("itr",["require","exports","module","./iterator/array","./iterator/object","./iterator/number","lodash"],function(e){var t=e("./iterator/array"),r=e("./iterator/object"),n=e("./iterator/number"),i=e("lodash"),o=function(e){var o;return i.isArray(e)?o=t:i.isObject(e)?o=r:i.isNumber(e)&&(o=n),o.apply(this,arguments)};return o.object=r,o.array=t,o.number=n,o}),define("__deep__/keys",["require","exports","module"],function(){return function(e){return e.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").split(".")}}),define("__deep__/walker",["require","exports","module","lodash","itr","./keys"],function(e,t,r){var n=e("lodash"),i=e("itr"),o=e("./keys"),a=i.object.extend({nextStep:function(){var e=new RegExp("^"+this.currentKey()+"\\.");return this.nextKey().replace(e,"")},currentStep:function(){var e=new RegExp("^"+this.previousKey()+"\\.");return this.currentKey().replace(e,"")},previousStep:function(){var e=this.previousKey()||"";return n.last(e.split("."))},remainingSteps:function(){var e=new RegExp("^"+this.currentKey()+"\\.");return this.destination().replace(e,"")},destination:function(){return n.last(this.order)}});r.exports=function(e,t){t=n.isArray(t)?t:o(t);var r={"":e},i=[""];return n.every(t,function(o,a){var s=n.first(t,a+1).join(".");return i.push(s),e=e[o],r[s]=e,!n.isUndefined(e)}),a(r,{order:i})}}),define("__deep__/getset",["require","exports","module","lodash","./keys"],function(e,t){var r=e("lodash"),n=e("./keys");t.get=function(e,t){return t=r.isArray(t)?t:n(t),r.reduce(t,function(e,t){return e[t]},e)},t.set=function(e,i,o){i=r.isArray(i)?i:n(i);var a=i.pop();e=t.get(e,i),e[a]=o}}),define("deep",["require","exports","module","lodash","./__deep__/keys","./__deep__/walker","./__deep__/getset"],function(e){var t=e("lodash"),r={};return r.parseKeys=e("./__deep__/keys"),r.walker=e("./__deep__/walker"),t.extend(r,e("./__deep__/getset")),r}),define("containers",["lodash"],function(){function e(e,t){return _.all(t,function(t){return _.contains(e,t)})}function t(e,t){return _.any(t,function(t){return _.contains(e,t)})}function r(e,t){return e[0]<t&&t<e[1]}function n(e,t){return e[0]<=t&&t<=e[1]}function i(e,t,i){var o=i?r:n;return o=_.partial(o,e),_.isArray(t)?_.every(t,o):o(t)}return{containsAll:e,containsAny:t,exclusiveWithin:r,inclusiveWithin:n,within:i}}),define("__object-query__/operators/match",["require","exports","module","lodash"],function(e,t){var r=e("lodash");t.$matchSingle=function(e,t){return r.isRegExp(e)?e.test(t):e===t},t.$match=function(e,n){return r.isArray(n)?r.any(n,function(r){return t.$matchSingle(e,r)}):t.$matchSingle(e,n)}}),define("__object-query__/operators/range",["require","exports","module"],function(e,t){t.$lt=function(e,t){return e>t},t.$lte=function(e,t){return e>=t},t.$gt=function(e,t){return t>e},t.$gte=function(e,t){return t>=e}}),define("__object-query__/operators/set",["require","exports","module","lodash","containers"],function(e,t){var r=e("lodash"),n=e("containers");t.$in=function(e,t){return r.isArray(t)?n.containsAny(e,t):r.contains(e,t)},t.$nin=function(e,t){return r.isArray(t)?!n.containsAny(e,t):!r.contains(e,t)},t.$all=function(e,t){return n.containsAll(t,e)}}),define("__object-query__/operators/boolean",["require","exports","module"],function(e,t){t.$e=function(){},t.$ne=function(){},t.$not=function(){},t.$or=function(){},t.$and=function(){},t.$exists=function(){}}),define("__object-query__/operators/index",["require","exports","module","lodash","deep","containers","./match","./range","./set","./boolean"],function(e,t){var r=e("lodash");e("deep"),e("containers"),r.extend(t,e("./match"),e("./range"),e("./set"),e("./boolean")),t.evaluateValue=function(e,n){return r.isObject(e)&&!r.isRegExp(e)?r.every(e,function(e,r){var i=t[r];if(i)return i(e,n);throw new Error("The operator "+r+" is not supported by object-query.")}):t.$match(e,n)}}),define("__object-query__/match",["require","exports","module","lodash","deep","./operators/index"],function(e,t,r){var n=e("lodash"),i=e("deep"),o=e("./operators/index"),a=/[0-9]+/,s=function(e,t,r){return n.any(t,function(t){return u(e,t,r)})},u=r.exports=function(e,t,r){for(var u,l=i.walker(t,r);l.hasNext();){var c=l.next();if(!l.hasNext()){u=o.evaluateValue(e,c);break}if(n.isArray(c)&&!a.test(l.nextStep())){u=s(e,c,l.remainingSteps());break}}return u}}),define("__object-query__/find",["require","exports","module","lodash","deep","./operators/index"],function(e,t,r){var n=e("lodash"),i=e("deep"),o=e("./operators/index"),a=/[0-9]+/,s=function(e,t,r){return n.any(t,function(t){return u(e,t,r)})},u=r.exports=function(e,t,r){for(var u,l=i.walker(t,r);l.hasNext();){var c=l.next();if(!l.hasNext()){u=o.evaluateValue(e,c);break}if(n.isArray(c)&&!a.test(l.nextStep())){u=s(e,c,l.remainingSteps());break}}return u}}),define("object-query",["require","exports","module","lodash","./__object-query__/match","./__object-query__/find"],function(e){function t(e,t){return r.every(e,function(e,r){return n(e,t,r)})}var r=e("lodash"),n=e("./__object-query__/match");e("./__object-query__/find");var i=function(e){return e=e||{},r.partial(t,e)},o=["every","all","some","any","filter","find","reject"];return r.each(o,function(e){i[e]=function(t,n){return r[e](t,i(n))}}),i}),define("__backbone-ui-draggable/when",["require","exports","module","object-query"],function(e,t,r){var n=e("object-query");r.exports=function(e,t,r){var i=n(e),o=this.model;o.on("change",function(){i(o.toJSON())&&t.apply(r,[this])},this)}}),define("__backbone-ui-draggable/animate",["require","exports","module","lodash"],function(e,t,r){function n(e){this.moveX(e.left,{force:!0}),this.moveY(e.top,{force:!0})}var i=e("lodash");r.exports=function(e,t){var r=parseFloat(e.top),o=parseFloat(e.left),a={};if(!isNaN(r)){var s=parseFloat(this.get("top")),u=r-s,l=this.yAllowedDelta(u);e.top=s+l,a.top=u-l}if(!isNaN(o)){var c=parseFloat(this.get("left")),u=o-c,l=this.xAllowedDelta(u);e.left=c+l,a.left=u-l}t=t||{},t=i.isObject(t)?t:{duration:arguments[1],easing:arguments[2],complete:arguments[3]};var h=t.progress,d=this.$el.position();return t.progress=i.bind(function(){h&&h.apply(this.$el,arguments);var e=this.$el.position(),t={top:e.top-d.top,left:e.left-d.left};n.call(this,t),d=e},this),this.$el.animate(e,t),this}}),define("__backbone-ui-draggable/value-position",["require","exports","module","./helpers"],function(e,t){e("./helpers");t.initializeDraggableValuePosition=function(){var e=this.model,t=this.valueAttribute;if(this.listenTo(e,"change:"+t,function(e){var r=this.toPosition(e.get(t));e.set({top:parseFloat(r.top),left:parseFloat(r.left)})},this),e.get(t)){var r=this.toPosition(e.get(t));e.set({top:parseFloat(r.top),left:parseFloat(r.left)})}else e.set(t,this.toValue(e))},t.valueAttribute="value",t.setValue=function(e){return this.model.set(this.valueAttribute,e),this},t.toValue=function(e){return"At "+e.get("top")+" x "+e.get("left")},t.toPosition=function(e){var t=e.split("x"),r={top:parseFloat(t[0].replace(/[^0-9.\-]/g,"")),left:parseFloat(t[1].replace(/[^0-9.\-]/g,""))};return r}}),define("__backbone-ui-draggable/movement",["require","exports","module","lodash","./helpers"],function(e,t){var r=e("lodash"),n=e("./helpers");t.xAllowedDelta=function(e){var t=this.model,r=parseFloat(t.get("left")),i=r+e,o=parseFloat(this.$el.width()),a=parseFloat(t.get("minLeft")),s=parseFloat(t.get("minRight")),u=n.max(a,s-o),l=parseFloat(t.get("maxLeft")),c=parseFloat(t.get("maxRight")),h=n.min(l,c-o),d=n.fitValueWithin(i,u,h);return d-r},t.moveX=function(e,t){if(e){if(t=t||{},-1===this.axis.indexOf("x"))return e;var n=this.model,i=t.force?e:this.xAllowedDelta(e);if(n.set("left",parseFloat(n.get("left"))+i),n.set(this.valueAttribute,this.toValue(n)),!t.silent&&0!==i){var o=r.assign({axis:"x",delta:i,direction:i>0?"right":"left"},t);this.trigger("move",this,o).trigger("move-x",this,o)}return e-i}return 0},t.yAllowedDelta=function(e){var t=this.model,r=parseFloat(t.get("top")),i=r+e,o=parseFloat(this.$el.height()),a=parseFloat(t.get("minTop")),s=parseFloat(t.get("minBottom")),u=n.max(a,s-o),l=parseFloat(t.get("maxTop")),c=parseFloat(t.get("maxBottom")),h=n.min(l,c-o),d=n.fitValueWithin(i,u,h);return d-r},t.moveY=function(e,t){if(e){if(t=t||{},-1===this.axis.indexOf("y"))return e;var n=this.model,i=this.yAllowedDelta(e);if(n.set("top",parseFloat(n.get("top"))+i),n.set(this.valueAttribute,this.toValue(n)),!t.silent&&0!==i){var o=r.assign({axis:"y",delta:i,direction:i>0?"bottom":"top"},t);this.trigger("move",this,o).trigger("move-y",this,o)}return e-i}return 0},t.moveToLeft=function(e,t){return-1*this.moveX(-1*e,t)},t.moveToRight=function(e,t){return this.moveX(e,t)},t.moveToTop=function(e,t){return-1*this.moveY(-1*e,t)},t.moveToBottom=function(e,t){return this.moveY(e,t)}}),define("__backbone-ui-draggable/event-handlers",["require","exports","module"],function(e,t){t.mousedown=function(e){if(this.$el.is(e.target)&&1===e.which&&!this.model.get("disabled")){this.model.set("status","dragging"),this.lastPosition={x:e.pageX,y:e.pageY};var t=this.$el.offset();return this.handlePosition={x:e.pageX-t.left,y:e.pageY-t.top},this.$window.on("mousemove",this.mousemove).on("mouseup",this.mouseup),this.trigger("movestart",this),!1}},t.mousemove=function(e){var t=this.lastPosition,r=e.pageX,n=e.pageY,i=r-t.x,o=n-t.y,a=this.$el.offset(),s=this.handlePosition.x+a.left,u=this.handlePosition.y+a.top;return(i>0&&r>s||0>i&&s>r)&&this.moveX(i,{agent:"mousemove"}),(o>0&&n>u||0>o&&u>n)&&this.moveY(o,{agent:"mousemove"}),t.x=r,t.y=n,!1},t.mouseup=function(){this.$window.off("mousemove",this.mousemove),delete this.lastPosition,this.model.set("status","stopped"),this.trigger("movestop",this)}}),define("backbone-ui-draggable",["require","exports","module","lowercase-backbone","model-dock","lodash","jquery","./__backbone-ui-draggable/helpers","./__backbone-ui-draggable/when","./__backbone-ui-draggable/animate","./__backbone-ui-draggable/value-position","./__backbone-ui-draggable/movement","./__backbone-ui-draggable/event-handlers"],function(e,t,r){var n=e("lowercase-backbone"),i=e("model-dock"),o=e("lodash"),a=e("jquery"),s=e("./__backbone-ui-draggable/helpers"),u=r.exports=i.extend({initialize:function(e){n.view.prototype.initialize.call(this,e),this.initializeModelDock(e),this.initializeUIDraggable(e)},initializeUIDraggable:function(e){o.bindAll(this,"mousedown","mousemove","mouseup"),this.$el.addClass(this.draggableClass),this.$window=a(window),this.$canvas=e.canvas||this.canvas||this.$el.parent();var t=this.$el.position(),r=a.extend({status:"stopped",disabled:!1,top:parseFloat(t.top),left:parseFloat(t.left)},e),n=this.model;n.set(r),this.listenTo(n,"change:disabled",function(e){e.get("disabled")?this.$el.removeClass(this.draggableClass+"-enabled").addClass(this.draggableClass+"-disabled"):this.$el.removeClass(this.draggableClass+"-disabled").addClass(this.draggableClass+"-enabled")}),this.initializeDraggableValuePosition(e)},draggableClass:"draggable",events:{mousedown:"mousedown"},when:e("./__backbone-ui-draggable/when"),animate:e("./__backbone-ui-draggable/animate"),disableDraggable:function(){this.model.set("disabled",!0)},enableDraggable:function(){this.model.set("disabled",!1)},axis:"xy",map:{left:"->css:left",top:"->css:top"},stringifiers:{left:s.stringifyPositionalValue,top:s.stringifyPositionalValue}});u.proto(e("./__backbone-ui-draggable/value-position")),u.proto(e("./__backbone-ui-draggable/movement")),u.proto(e("./__backbone-ui-draggable/event-handlers"))});